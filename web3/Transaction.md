# Transaction

트랜잭션은 EOA에 의해 서명된 메시지로 이더리움 네트워크에 의해 전송되고 이더리움 블록체인에 기록됩니다. 트랜잭션은 EVM에서 상태 변경을 유발하거나 컨트랙트를 실행할 수 있는 유일한 방법입니다. 이더리움은 글로벌 싱글톤 상태 머신이며, 트랜잭션은 이 상태 머신을 움직여서 상태를 변경할 수 있도록 만듭니다.

컨트랙트와 이더리움은 자율적으로 실행되지 않으며 모든 것은 트랜잭션으로부터 시작됩니다.

## 트랜잭션 구조

먼저 이더리움 네트워크에서 직렬화되어 전송되는 트랜잭션의 기본 구조를 살펴봅시다. 직렬화된 트랜잭션을 수신하는 각 클라이언트와 애플리케이션은 자체 내부 데이터 구조를 사용하여 트랜잭션을 메모리에 저장하며, 네트워크에서 직렬화된 트랜잭션 자체에는 존재하지 않는 메타데이터가 포함되어 있습니다. 네트워크 직렬화는 트랜잭션의 유일한 표준 형식입니다.

트랜잭션은 다음 데이터를 포함하는 직렬화된 바이너리 메시지 입니다.

- **nonce** : 발신 EOA에 의해 발행되어 메시지 재사용을 방지하는 데 사용되는 일련번호
- **gas price** : 발신자가 지급하는 가스의 가격(wei)
- **gas limit** : 이 트랜잭션을 위해 구입할 가스의 최대량
- **수신자(recipient)** : 목적지 이더리움 주소
- **value** : 목적지에 보낼 이더의 양
- **data** : 가변 길이 바이너리 데이터 페이로드
- **v, r, s** : EOA의 ECDSA 디지털 서명의 세 가지 구성요소

### 트랜잭션 논스(nonce)

논스는 발신 주소의 속성이고 발신 주소의 컨텍스트 안에서만 의미를 갖습니다. 논스는 명시적으로 블록체인 계정 상태에 저장되지 않고, 해당 주소에서 발생한 확인된 트랜잭션 건수를 세어서 동적으로 계산되는 값입니다.

논스의 중요성 중 하나는 트랜잭션 생성 순서대로 포함된다느 점에서 생기는 사용성상의 기능이고, 다른 하나는 트랜잭션 복제 방지라는 주요 기능에서의 측면입니다.

### 트랜잭션 가스

가스는 이더리움의 연료입니다. 가스는 이더가 아니라 이더에 대한 자체 환율을 가진 별도의 가상 화폐입니다. 이더리움은 가스를 사용하여 트랜잭션이 사용할 수 있는 자원의 양을 제어합니다. 이는 전 세계 수천 대의 컴퓨터에서 처리되기 때문에 Dos 공격이나 실수로 막대한 자원을 소모하는 트랜잭션을 피하기 위해 특정한 형태의 미터링(metering)이 필요합니다.

가스는 이더 가치의 급격한 변화와 함께 발생할 수 있는 변동성으로부터 시스템을 보호하고, 가스가 지급하는 다양한 자원(즉, 계산, 메모리 및 저장)의 비용 사이의 중요하고 민감한 비율을 관리하기 위해 가스를 이더와 분리한다.

트랜잭션의 gasPrice 필드는 트랜잭션 생성자가 가스와 교환하여 지급할 가격을 설정할 수 있게 합니다. gasPrice가 높을수록 트랜잭션이 더 빨리 컨펌될 것입니다. 반대로 적을수록 느려지구요. 가스비의 최저값은 0인데, 이는 수수료가 없는 트랜잭션을 의미합니다. 블록 공간에 대한 수요가 낮은 기간에는 수수료가 0인 트랜잭션들도 블록에 포함될 수 있습니다.

## 트랜잭션 수신자

to 필드에는 트랜잭션 수신자가 지정됩니다. 20바이트 이더리움 주소를 포함하며, 주소는 EOA 또는 컨트랙트 주소일 수 있습니다.

이더리움은 이 필드를 더는 검증하지 않습니다. 모든 20바이트 값은 유효한 것으로 간주합니다. 이더리움은 주소가 공개키(따라서 개인키)에서 올바르게 파생되었는지 여부를 알 수 있는 방법이 없다.

트랜잭션을 잘못된 주소로 보내면, 대부분의 경우에 해당 주소에 대응하는 개인키도 알 수 없고 서명도 만들 수 없기 때문에, 보내진 이더는 다시 사용할 수 없는 상태가 되므로 영원히 소실된 것으로 간주할 수 있습니다. 주소 확인은 사용자 인터페이스 수준에서 처리해야 한다고 가정합니다. 이더를 연소시키는 데는 여러 가지 정당한 이유가 있을 수 있습니다. 예를 들자면, 지급 채널 및 기타 스마트 컨트랙트에서의 부정행위를 저지하는 것이나, 이더의 양이 유한하므로 이더를 연소시키면 모든 이더 보유자에게 연소된 값을 효과적으로 분배한 것으로 이해할 수 있습니다.

## 트랜잭션 값과 데이터

트랜잭션의 주요 '페이로드'는 값과 데이터라는 2개의 필드에 포함됩니다.

트랜잭션은 갑과 데이터, 값만, 데이터만 또는 값이나 데이터를 모두 가지지 않는 네 가지 조합이 모두 유효합니다.

값만 있는 트랜잭션은 지급(Payment) 입니다. 데이터만 있는 트랜잭션은 호출(invocation)입니다. 값과 데이터 모두를 사용한 트랜잭션은 지급과 호출입니다. 값과 데이터가 모두 없는 트랜잭션은 단지 가스 낭비일 뿐입니다.