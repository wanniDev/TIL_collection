# 애플리케이션 서버 모니터링 시스템 적용하기 -1-

**모니터링 시스템이 필요한 이유**

고객의 요구사항을 충실히 반영하는 것만큼 어떠한 경우에도 일정한 서비스를 누구에게나 제공할 수 있는 서버를 구성하는 것도 중요합니다. 그럴러면, 먼저 서버에서 수행되는 트랜잭션 비즈니스 로직의 **처리량, 지연시간, 가용성** 등을 최대한 정확히 측정할 수 있어야합니다. 아무리, 컴퓨터 공학에 대한 깊은 지식과 경험을 가지고 있는 개발자라도 소스코드만을 보고는 이 세 가지 요소를 정확하게 예측할 수는 없습니다.

따라서, 어느정도 비즈니스 로직이 마무리되면 단위 테스트 외에도, 성능 테스트, 강도 테스트 등을 수행하고 모니터링 시스템을 통해 테스트 시나리오에 따라 소모되는 리소스와 서버의 스펙에 따라 트래픽을 어느정도 받아들일 수 있는지에 대한 근사치를 구할 수 있는 환경이 필요합니다.

모니터링 시스템은 기본적으로 '**데이터 수집 -> 통합 -> 시각화**' 의 단계로 되어있습니다.

## 모니터링 시스템 1: elk 스택

대표적인 모니터링 시스템 솔루션으로 Elasticsearch, Logstash, Kibana 이 세 가지의 프로젝트로 구성된 스택을 의미합니다.

**Elasticsearch**

Apache Lucene에 구축되어있는 검색 및 분석 엔진입니다. 다양한 언어를 지원하고 고성능에 스키마가 없는 JSON 문서로 Elasticsearch는 다양한 로그 분석과 검색 사용 사례가 있습니다.

**Logstash**

다양한 소스로부터 데이터를 수집하고 곧바로 원하는 대상에게 전송할 수 있도록 돕는 오픈 소스 데이터 콜렉터입니다. 사전 구축된 필터와 다양한 오픈 소스 플러그인을 통해 인덱싱을 돕습니다. Logstash는 Elasticsearch에 데이터를 로드할 때 많이 사용됩니다.

**Kibana**

데이터 시각화 및 탐색 도구입니다.

**ELK 스택의 대표적인 작동방식**

1. Logstash는 데이터를 수집 및 변환하고 올바른 대상으로 전송합니다.
2. Elasticsearch는 수집된 데이터를 인덱싱하고, 분석하고, 검색합니다.
3. Kibana는 분석 결과를 시각화합니다.

## 모니터링 시스템 2: Prometheous, Grapana

**Prometheus**

- K8s, Jaeger, Mixer 등의 CNCF의 프로젝트들은 대부분 프로메테우스를 지원합니다.
- 분산 스토리지에 대한 종속성이 없고 단일 서버 노드는 자율적입니다.
- K8s나 Docker Engine은 Container & Node의 Metric을 내보내는 Endpoint를 자체적으로 지원하고 있기 때문에, 프로메테우스와 연동하면 소스 코드없이 모니터링 시스템 구축이 가능합니다.

**Grafana**

- 30가지 이상의 다양한 수집 도구 및 DB들과 연계를 지원합니다.
- 관계형 데이터비스 데이터를 시각화 하여 사용할 수 있습니다.
- 개별 사용자들이 만들어 둔 대시보드의 공유가 매우 활발합니다.
- 오픈 소스로서 사용자의 요구 사항에 맞게 수정 가능하며 필요에 따라 설치형과 서비스형 모두 선택 가능합니다.





## 출처

- https://aws.amazon.com/ko/what-is/elk-stack/
- https://blog.bespinglobal.com/post/springboot-prometheus-grafana%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-monitoring-%EA%B5%AC%EC%B6%95/

