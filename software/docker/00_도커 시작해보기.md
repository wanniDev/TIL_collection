# 도커 시작하기

도커 공식 문서를 해석하면서, 도커에 대해 배우고 내용을 정리해보고자 합니다.

## Container?

컨테이너는 호스트 시스템에서 다른 프로세스와 완전히 격리된 프로세스를 동작시키는 기술입니다.

- 컨테이너는 이미지의 실행 가능한 인스턴스의 형태이며, 도커API 혹은 CLI를 활용하여 컨테이너를 생성, 시작, 중지, 이동 또는 삭제가 가능합니다.
- 또한 로컬 머신 혹은 가상 머신에서 실행하거나 클라우드에 배포할 수 있습니다.
- 이식 가능합니다.
- 다른 컨테이너와 격리되고 자체 소프트웨어, 바이너리 및 구성을 실행합니다.

## Image?

이미지는 서비스 운영에 필요한 서버 프로그램, 소스코드 및 라이브러리, 컴파일된 실행 파일을 묶는 형태를 이야기 합니다. 애플리케이션을 실행하는 데 필요한 모든 것이 포함되어 있습니다. 이미지에는 환경 변수, 실행에 필요한 기본 명령 및 기타 메타데이터 등이 필요합니다.

> `chroot` 컨테이너의 확장된 버전으로 생각하면 편합니다.

## 애플리케이션 컨테이너화 해보기

1. 아래 명령어로 리포지토리를 복사해옵니다.

   ```git
   git clone https://github.com/docker/getting-started.git
   ```

2. 아래 이미지처럼 파일이 구성되어 있는지 확인해보세요.

![image](https://github.com/wanniDev/TIL_collection/assets/81374655/4c9cf0ca-227b-4cd3-8f7e-c06dbcddf088)

## 애플리케이션 컨테이너 이미지 빌드

도커 이미지를 빌드하려면`Dockerfile`이 필요합니다. `Dockerfile`은 컨테이너 이미지를 빌드하는데 필요한 내용들이 포함된 확장자가 없는 단순 텍스트 기반 파일 파일입니다.

app 디렉토리로 이동해주세요.

```shell
$ cd /path/to/app
```

그리고 `Dockerfile`을 만들어주세요.

```shell
$ touch Dockerfile
```

그리고 도커를 빌드해주세요.

```shell
$ docker build -t getting-started .
```

이후 수많은 커맨드 라인을 보시면, 도커로 인해 다운로드되는 수많은 layer들을 보시게 될겁니다.

`docker build`는 `Dockerfile`의 내용을 바탕으로 새로운 컨테이너 이미지를 만들어주는 명령어입니다. layer들이 쌓이는 이유는 `node:18-alpine` 이미지를 쌓는 과정이 포함되어 있기 때문입니다.

도커가 선행조건으로 필요한 이미지를 다운로드한 이후로 Dockerfile은 `yarn` 명령어를 통해 애플리케이션의 의존성을 구성하는데 필요한 파일들을 복사, 설치합니다.

`-t` 플래그는 이미지에 태그를 다는 것입니다. 간단하게는 이미지에 휴먼 리더블한 명칭을 달아준다고 보면 됩니다. 명령어에는 `-t getting-started`라고 작성했는데 이는 빌드되는 이미지에 `getting-started`라는 명칭이 작성됩니다.

## 컨테이너 시작하기

이미지가 빌드되었으면, 이제 이미지를 컨테이너에 띄어서 실행할 수 있씁니다. `docker run` 명령어를 사용하면 실행할 수 있습니다.

```shell
$ docker run -dp 3000:3000 getting-started
```

`-d`는 detached 모드를 의미하며, 컨테이너가 백그라운드에서 실행하게 합니다. `p` 는 호스트의 포트번호를 지정하는 키워드로 호스트의 포트 3000과 컨테이너의 포트 3000을 매핑하게 합니다. 포트 매핑이 없으면 당신은 애플리케이션에 접근할 수 없습니다.

위 명령어를 실행하고 몇 초 정도 기다리고 `http://localhost:3000/`로 가보면 투두 앱을 보실 수 있습니다.

![image](https://github.com/wanniDev/TIL_collection/assets/81374655/dbdd2dc0-153d-4d04-9fc2-812c11c5c701)

위의 콘솔 명령어를 진행했다면 도커 데스크톱에서 다음과 같이 컨테이너가 만들어져 있는걸 확인해볼 수 있습니다.

![image](https://github.com/wanniDev/TIL_collection/assets/81374655/09b7bde3-1fe2-43d2-9205-3c6dd90d5b2f)

> 출처

https://docs.docker.com/get-started/